<?xml version="1.0" encoding="utf-8"?>

<openerp>
    <data>
    <!--START VIEWS-->
        <!-- FORM VIEW-->
        <record model="ir.ui.view" id="view_form_budget_inherit_project">
            <field name="name">Budget Inherit</field>
            <field name="model">budget.core.budget</field>
            <field name="inherit_id" ref="view_form_budget"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='name']" position="before">
                    <field name="is_project" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='name']" position="attributes">
                    <attribute name="attrs">{'invisible': [('is_project', '==', True)]}</attribute>
                </xpath>
                <xpath expr="//field[@name='name']" position="after">
                    <field name="project_no" default_focus="1" placeholder="Project No"
                           attrs="{'invisible': [('is_project', '!=', True)]}"/>
                </xpath>
                <xpath expr="//field[@name='expenditure_amount']" position="before">
                    <!--write_date already exist in budget form view-->
                    <field name="initial_commitment_amount"
                           attrs="{'invisible': ['|', ('is_project', '!=', True), ('write_date', '!=', False)]}"/>
                    <field name="commitment_amount"
                           attrs="{'invisible': ['|', ('is_project', '!=', True), ('write_date', '==', False)]}"/>
                </xpath>
                <xpath expr="//field[@name='history_ids']" position="replace">
                    <field name="history_ids"
                           context="{'default_is_project_history': is_project}"/>
                </xpath>
            </field>
        </record>
        <!--TREE VIEW-->
        <record model="ir.ui.view" id="view_tree_budget_inherit_project">
            <field name="name">Budget Inherit</field>
            <field name="model">budget.core.budget</field>
            <field name="inherit_id" ref="view_tree_budget"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='expenditure_amount']" position="after">
                    <field name="commitment_amount" invisible="not context.get('default_is_project', False)"/>
                </xpath>
            </field>
        </record>
    <!--END VIEWS-->

    <!--START ACTIONS-->
        <!--Budget Action-->
        <record model="ir.actions.act_window" id="action_budget_inherit_project">
            <field name="name">Project</field>
            <field name="res_model">budget.core.budget</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,pivot,graph</field>
            <field name="view_id" ref="view_tree_budget_inherit_project"/>
            <field name="domain">[('is_project', '=', True)]</field>
            <field name="context">{'default_is_project': True,
                                   'form_view_ref': 'budget_core.view_form_budget_inherit_project'}</field>
        </record>
    </data>
</openerp>